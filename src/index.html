<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Balls</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

      <style>
        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #renderCanvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
    </style>
     <script src="https://cdn.babylonjs.com/cannon.js"></script>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
        <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="../assets/js/babylon.gridMaterial.min.js"></script>
    <script src="https://code.jquery.com/pep/0.4.1/pep.js"></script>
</head>
<body>


   <canvas id="renderCanvas" touch-action="none"></canvas> 

    <script>
    	 var canvas = document.getElementById("renderCanvas"); // Get the canvas element 

            var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine
  var gravityVector = new BABYLON.Vector3(1,10, 0);
    var physicsPlugin = new BABYLON.CannonJSPlugin();
 /******* Add the create scene function ******/
var createScene = function () {

    // This creates a basic Babylon Scene object (non-mesh)
    var scene = new BABYLON.Scene(engine);

    // This creates and positions a free camera (non-mesh)
    var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(-10, 2, 10), scene);

    // This targets the camera to scene origin
    camera.setTarget(BABYLON.Vector3.Zero());

    // This attaches the camera to the canvas
    camera.attachControl(canvas, true);

    // This creates a light, aiming 0,1,0 - to the sky (non-mesh)
    var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);

    // Default intensity is 1. Let's dim the light a small amount
    light.intensity = 0.7;

    // Our built-in 'sphere' shape. Params: name, subdivs, size, scene
    var sphere = BABYLON.Mesh.CreateSphere("sphere1", 16, 1, scene);

      var sphereTwo = BABYLON.Mesh.CreateSphere("sphere2", 16, 2, scene);

    // Move the sphere upward 1/2 its height
     sphere.position.z = -4;
    sphere.position.y =1;
     sphereTwo.position.x =-4;
      sphereTwo.position.y =2;
       sphereTwo.position.z = -1;

	var grass1 = new BABYLON.StandardMaterial("grass1", scene);
	grass1.emissiveTexture = new BABYLON.Texture("textures/grass.png", scene);
    // Our built-in 'ground' shape. Params: name, width, depth, subdivs, scene
    var ground = BABYLON.Mesh.CreateGround("ground1", 16, 16, 2, scene);
   	var box = BABYLON.MeshBuilder.CreateBox("box", {height: .1, width:.1, depth: .1, scene});
  
	box.position.y = 1;
    	box.position.x =-4;
    	box.position.z = -1;
    scene.enablePhysics();
		var grid = new BABYLON.GridMaterial("grid", scene);	
		var gridTwo = new BABYLON.GridMaterial("grid", scene);	
		var gridThree = new BABYLON.GridMaterial("grid", scene);	

	grid.gridRatio = 0.1;
	gridTwo.gridRatio = 0.5;
	gridThree.gridRatio = 0.1;
	grid.majorUnitFrequency = 2;
	gridTwo.majorUnitFrequency = 2;
	gridThree.majorUnitFrequency = 2;
	// Set the diffuse texture
    sphere.material = grid;
    grid.lineColor = new BABYLON.Color4.FromHexString("#77e0f8FF");
      gridTwo.lineColor = new BABYLON.Color4.FromHexString("#54f64cFF");
        gridThree.lineColor = new BABYLON.Color4.FromHexString("#77e0f8FF");
    sphereTwo.material = grid;
    ground.material = gridTwo;

	sphere.physicsImpostor = new BABYLON.PhysicsImpostor(sphere, BABYLON.PhysicsImpostor.SphereImpostor, { mass:100, restitution: .2, friction: 1000 }, scene);
    sphereTwo.physicsImpostor = new BABYLON.PhysicsImpostor(sphereTwo, BABYLON.PhysicsImpostor.SphereImpostor, { mass: 1, restitution: .5 }, scene);
    box.physicsImpostor = new BABYLON.PhysicsImpostor(box, BABYLON.PhysicsImpostor.SphereImpostor, { mass:1000, restitution:1 }, scene);
	ground.physicsImpostor = new BABYLON.PhysicsImpostor(ground, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.1, friction: 1000 }, scene);
    
    sphere.physicsImpostor.applyImpulse(new BABYLON.Vector3(12, .2, .3), sphere.getAbsolutePosition());
     box.physicsImpostor.applyImpulse(new BABYLON.Vector3(-1, 12, -10), box.getAbsolutePosition());
	//sphere.physicsImpostor.setLinearVelocity(new BABYLON.Vector3(1, 0, 1));
 // box.physicsImpostor.setLinearVelocity(new BABYLON.Vector3( -3, 2,1));
var g = new BABYLON.Vector3(0, -10, 0);

  
    scene.getPhysicsEngine().setGravity(g);
    return scene;

};

                /******* End of the create scene function ******/    

                var scene = createScene(); //Call the createScene function

            engine.runRenderLoop(function () { // Register a render loop to repeatedly render the scene
                    scene.render();
            });


            window.addEventListener("resize", function () { // Watch for browser/canvas resize events
                    engine.resize();
            });
    </script>
</body>
</html>
